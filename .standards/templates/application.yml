# Default Profile Configuration Template
# Profile: default (implicit - no suffix)
# Environment: Local development
# Usage: mvn spring-boot:run

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
server:
  port: 8081  # Change per service: 8081 (auth), 8082 (student), 8083 (teacher), etc.

# =============================================================================
# SPRING APPLICATION
# =============================================================================
spring:
  application:
    name: auth-service  # Change to match your service name (lowercase, hyphen-separated)

  # ---------------------------------------------------------------------------
  # DATABASE CONFIGURATION (PostgreSQL)
  # ---------------------------------------------------------------------------
  datasource:
    url: jdbc:postgresql://localhost:5432/auth_db  # Database URL for local PostgreSQL
    username: sms_user                              # Database username
    password: ${DB_PASSWORD:password}               # Password (default: 'password' for local dev)
    driver-class-name: org.postgresql.Driver

  # ---------------------------------------------------------------------------
  # JPA/HIBERNATE CONFIGURATION
  # ---------------------------------------------------------------------------
  jpa:
    hibernate:
      ddl-auto: validate  # NEVER use 'update' or 'create-drop' - use Flyway migrations
    show-sql: false       # Set to true for debugging SQL queries
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true  # Format SQL output for readability

  # ---------------------------------------------------------------------------
  # FLYWAY DATABASE MIGRATION
  # ---------------------------------------------------------------------------
  flyway:
    enabled: true
    baseline-on-migrate: true          # Allow migrations on non-empty database
    locations: classpath:db/migration  # Migration scripts location
    schemas: public                     # Database schema

  # ---------------------------------------------------------------------------
  # REDIS CONFIGURATION (Optional - if service uses caching)
  # ---------------------------------------------------------------------------
  data:
    redis:
      host: localhost
      port: 6379
      lettuce:
        pool:
          max-active: 10  # Maximum number of connections in pool
          max-idle: 5     # Maximum idle connections
          min-idle: 2     # Minimum idle connections
          max-wait: 2000  # Max wait time (ms) when pool exhausted

# =============================================================================
# EUREKA SERVICE DISCOVERY
# =============================================================================
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/  # Eureka server URL (local)
  instance:
    prefer-ip-address: true  # Use IP for local development (OK for non-Docker)

# =============================================================================
# JWT CONFIGURATION (Custom Application Properties)
# =============================================================================
jwt:
  secret: ${JWT_SECRET:your-256-bit-secret-key-here-minimum-32-chars}  # JWT signing secret (256-bit minimum)
  expiration: 86400000              # Access token expiration (24 hours in milliseconds)
  refresh-expiration: 2592000000    # Refresh token expiration (30 days in milliseconds)

# =============================================================================
# CUSTOM APPLICATION PROPERTIES
# =============================================================================
# Use 'app.*' namespace for custom application-specific settings

app:
  # Photo upload configuration (example - remove if not needed)
  photo:
    upload-dir: ./uploads/profile-photos  # Local directory for uploaded photos
    max-file-size: 5242880                 # Max file size (5MB in bytes)
    allowed-types:
      - image/jpeg
      - image/png

  # CORS configuration (example - can also be in CorsConfig.java)
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000}  # Frontend URL

# =============================================================================
# ACTUATOR ENDPOINTS (Health Checks)
# =============================================================================
management:
  endpoints:
    web:
      exposure:
        include: health,info  # Expose health and info endpoints
  endpoint:
    health:
      show-details: always  # Show detailed health information

# =============================================================================
# SPRINGDOC/SWAGGER CONFIGURATION (API Documentation)
# =============================================================================
springdoc:
  api-docs:
    path: /v3/api-docs       # OpenAPI 3 JSON documentation path
  swagger-ui:
    path: /swagger-ui.html   # Swagger UI path
  show-actuator: false       # Don't show actuator endpoints in Swagger

# =============================================================================
# LOGGING CONFIGURATION (Optional)
# =============================================================================
# Uncomment and customize as needed

# logging:
#   level:
#     root: INFO
#     com.sms.auth: DEBUG              # Set your package to DEBUG for development
#     org.hibernate.SQL: DEBUG         # Show SQL queries
#     org.hibernate.type.descriptor.sql.BasicBinder: TRACE  # Show SQL parameters

# =============================================================================
# NOTES
# =============================================================================
# 1. This file is for LOCAL DEVELOPMENT only
# 2. Default values allow running service without environment variables
# 3. For Docker deployment, use application-docker.yml
# 4. NEVER commit secrets to version control
# 5. Use ${VARIABLE:default} pattern for optional config
# 6. Use ${VARIABLE} (no default) for required config in production
